<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>学生宿舍信息管理系统</title>
    <script src="js/vue.js"></script>
    <script src="js/axios.js"></script>
    <script src="element-ui/lib/index.js"></script>

    <link rel="stylesheet" type="text/css" href="css/user-admin.css">
    <!--element样式-->
    <link rel="stylesheet" href="element-ui/lib/theme-chalk/index.css">

</head>

<body>
    <!-- 顶部 -->
    <div class="banner">
        <span>学生宿舍信息管理系统</span>
    </div>
    <!-- 主体 -->
    <div class="container" id="container">
        <!-- 侧边栏 -->
        <div class="sideBar">
            <ul>
                <li @click="change1()">学生管理</li>
                <li @click="change2()">宿舍管理</li>
                <li @click="change3()">出入登记</li>
                <li @click="change4()">报修管理</li>
                <li @click="change5()">费用明细</li>
                <li @click="change6()">管理员</li>
            </ul>
        </div>
        <!-- 信息展示 -->
        <div class="showInfo" v-show="count == 1">
            <el-form :inline="true" :model="stuInfoByCondition" class="demo-form-inline">
                <el-form-item label="学号">
                    <el-input v-model="stuInfoByCondition.sno" placeholder="输入学号搜索"></el-input>
                </el-form-item>
                <el-form-item label="宿舍号">
                    <el-input v-model="stuInfoByCondition.departmentId" placeholder="输入宿舍号搜索"></el-input>
                </el-form-item>
                <el-form-item label="姓名">
                    <el-input v-model="stuInfoByCondition.name" placeholder="输入姓名搜索"></el-input>
                </el-form-item>

                <el-form-item>
                    <el-button type="primary" @click="onSubmit">查询</el-button>
                </el-form-item>

            </el-form>

            <el-row>
                <el-button type="primary" plain @click="dialogVisible=true">新增信息</el-button>
                <el-button type="danger" plain>批量删除</el-button>
            </el-row>
                <!--添加对话框表单-->
                <el-dialog
                        title="新增学生信息"
                        :visible.sync="dialogVisible"
                        width="30%">

                    <!--对话框内容-->
                    <el-form ref="form" :model="stuInfo" label-width="80px">
                        <el-form-item label="学号" >
                            <el-input v-model="stuInfo.sno"></el-input>
                        </el-form-item>

                        <el-form-item label="宿舍号">
                            <el-input v-model="stuInfo.departmentId"></el-input>
                        </el-form-item>

                        <el-form-item label="姓名">
                            <el-input v-model="stuInfo.name"></el-input>
                        </el-form-item>

                        <el-form-item label="性别">
                            <el-input v-model="stuInfo.gender"></el-input>
                        </el-form-item>

                        <el-form-item label="联系电话">
                            <el-input v-model="stuInfo.tel"></el-input>
                        </el-form-item>

                        <el-form-item align="center">
                            <el-button type="primary" @click="addStuInfo">提交</el-button>
                            <el-button>取消</el-button>
                        </el-form-item>

                    </el-form>
                </el-dialog>



            <div class="searchResults">
                <template>
                    <el-table
                            ref="multipleTable"
                            :data="tableData"
                            tooltip-effect="dark"
                            style="width: 100%"
                            @selection-change="handleSelectionChange">
                        <el-table-column
                                type="selection"
                                align="center">
                        </el-table-column>
                        <el-table-column
                                type="index"
                                width="50">
                        </el-table-column>
                        <el-table-column
                                prop="sno"
                                label="学号"
                                align="center">
                        </el-table-column>
                        <el-table-column
                                prop="departmentId"
                                label="宿舍号"
                                align="center">
                        </el-table-column>
                        <el-table-column
                                prop="name"
                                label="姓名"
                                align="center">
                        </el-table-column>
                        <el-table-column
                                prop="gender"
                                label="性别"
                                align="center">
                        </el-table-column>
                        <el-table-column
                                prop="tel"
                                label="电话号码"
                                align="center">
                        </el-table-column>
                        <el-table-column
                                label="操作"
                                align="center"
                                show-overflow-tooltip>
                            <el-row>
                                <el-button type="primary">修改</el-button>
                                <el-button type="danger">删除</el-button>
                            </el-row>
                        </el-table-column>
                    </el-table>
<!--                    <div style="margin-top: 20px">-->
<!--                        <el-button @click="toggleSelection()">取消选择</el-button>-->
<!--                    </div>-->
                </template>
            </div>
            <!--分页工具条-->

            <el-pagination
                @size-change="handleSizeChange"
                @current-change="handleCurrentChange"
                :current-page="currentPage"
                :page-sizes="[5, 10, 15, 20]"
                :page-size="100"
                layout="total, sizes, prev, pager, next, jumper"
                :total="totalCount">
            </el-pagination>
        </div>


    </div>

    <script>
        new Vue({
            el:"#container",
            data:{
                    count:1,
                    users:[],
                    // 表格数据
                    tableData: [{
                    }],
                    multipleSelection:[],
                    //搜索数据
                    stuInfoByCondition: {
                        sno:"",
                        departmentId:"",
                        name:""
                    },
                    //对话框表单数据
                    dialogVisible: false,
                    stuInfo: {
                        sno:"",
                        departmentId:"",
                        name:"",
                        gender:"",
                        tel:"",
                    },
                    rules: {
                        sno: [
                            { required: true, message: '请输入学生学号', trigger: 'blur' },
                            { min: 9, max: 12, message: '必填,长度在9至12个字符', trigger: 'blur' }
                        ],
                        departmentId: [
                            { required: true, message: '请输入学生宿舍号', trigger: 'blur' },
                            { min: 2, max: 5, message: '必填,长度在2至5个字符', trigger: 'blur' }
                        ],
                        name: [
                                { required: true, message: '请输入学生姓名', trigger: 'blur' },
                                { min: 2, max: 5, message: '必填,长度在2至5个字符', trigger: 'blur' }
                            ],
                        gender: [
                            { required: true, message: '请输入学生性别', trigger: 'blur' },
                            { min: 1, max: 1, message: '必填,长度为1个字符', trigger: 'blur' }
                        ],
                        tel: [
                            { required: true,message: '请输入学生电话号码', trigger: 'blur' },
                            { min: 11, max: 11, message: '必填', trigger: 'blur' }
                        ],
                        },

                    //分页工具条数据
                    currentPage: 1, //当前页码
                    totalCount:100, //总记录数
                    pageSize:5,     //每页显示条数 5
                    },
            // 页面加载完成后，发送异步请求，获取数据
            mounted(){
                this.selectAll();
                // let _this = this;
                // axios({
                //     method:"get",
                //     url:"http://localhost:8080/selectStuServlet"
                // }).then(function (resp){
                //     _this.tableData = resp.data;
                // })
            },
            methods:{
                //查询分页数据
                selectAll(){
                    // let _this = this;
                    // axios({
                    //     method:"get",
                    //     url:"http://localhost:8080/selectByPageServlet"
                    // }).then(function (resp){
                    //     _this.tableData = resp.data;
                    // })
                    let _this = this;
                    axios({
                        method:"post",
                        url:"http://localhost:8080/selectByPageAndConditionServlet?currentPage="+ _this.currentPage +"&pageSize="+ _this.pageSize,
                        data:this.stuInfoByCondition
                    }).then(function (resp){
                        _this.tableData = resp.data.rows;

                        _this.totalCount = resp.data.totalCount;
                    })
                },
                change1(){
                    this.count=1
                },
                change2(){
                    this.count=2
                },
                change3(){
                    this.count=3
                },
                change4(){
                    this.count=4
                },
                change5(){
                    this.count=5
                },

                //搜索方法
                onSubmit() {
                    //console.log(this.stuInfoByCondition);
                    this.selectAll();
                },
                //对话框内容方法   即新增学生信息方法
                addStuInfo(){
                    let that = this;
                    axios({
                        method:"post",
                        url:"http://localhost:8080/addStuServlet",
                        data:that.stuInfo
                    }).then(function(resp){
                        if(resp.data == "success"){
                            //关闭窗口
                            that.dialogVisible = false;
                            that.selectAll();
                            that.$message({
                                message: '恭喜你，添加成功',
                                type: 'success'
                            });
                        }
                    })
                },
                // 表格方法
                toggleSelection(rows) {
                    if (rows) {
                        rows.forEach(row => {
                            this.$refs.multipleTable.toggleRowSelection(row);
                        });
                    } else {
                        this.$refs.multipleTable.clearSelection();
                    }
                },
                //复选框选中后执行的方法
                handleSelectionChange(val) {
                    this.multipleSelection = val;
                    console.log(this.multipleSelection);
                },


                resetForm(formName) {
                    this.$refs[formName].resetFields();
                },
                //分页工具条方法
                handleSizeChange(val) {
                    //console.log(`每页 ${val} 条`);
                    this.pageSize = val;
                    this.selectAll();
                },
                handleCurrentChange(val) {
                    //console.log(`当前页: ${val}`);
                    this.currentPage = val;
                    this.selectAll();

                }
            }
        });
    </script>
</body>

</html>








<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>学生宿舍信息管理系统</title>
    <script src="js/vue.js"></script>
    <script src="js/axios-0.18.0.js"></script>
    <script src="element-ui/lib/index.js"></script>

    <link rel="stylesheet" type="text/css" href="css/user-stu.css">
    <!--element样式-->
    <link rel="stylesheet" href="element-ui/lib/theme-chalk/index.css">


</head>

<body>
<!-- 顶部 -->
<div class="banner">
    <span>学生宿舍信息管理系统</span>
</div>
<!-- 主体 -->
<div class="container" id="container">
    <!-- 侧边栏 -->
    <div class="sideBar">
        <ul>
            <li @click="change4()">所在宿舍信息查询</li>
            <li @click="change2()">宿舍楼电话查询</li>
            <li @click="change4()">出入登记</li>
            <li @click="change4()">报修管理</li>
            <li @click="change5()">费用明细</li>
        </ul>
    </div>
    <!-- 信息展示 -->
    <div class="showInfo" v-show="count == 2">
        <!--宿舍楼电话查询-->
        <div class="searchArea">
            <div class="searchTitle">搜索</div>
            <div class="search">
                <form>
                    <label>宿舍号
                        <input type="text" placeholder="请输入内容" class="search_input">
                    </label>
                    <el-button type="primary" icon="el-icon-search">搜索</el-button>
                </form>
            </div>
        </div>
        <div class="searchResults" style="margin-top: 10px">
            <template>
                <el-table
                        ref="multipleTable"
                        :data="tableData"
                        tooltip-effect="dark"
                        style="width: 100%"
                        @selection-change="handleSelectionChange">
                    <el-table-column
                            type="selection"
                            align="center">
                    </el-table-column>
                    <el-table-column
                            prop="DepartmentId"
                            label="宿舍号"
                            align="center">
                    </el-table-column>
                    <el-table-column
                            prop="name"
                            label="姓名"
                            align="center">
                    </el-table-column>
                    <el-table-column
                            prop="tel"
                            label="电话号码"
                            align="center"
                            show-overflow-tooltip>
                    </el-table-column>
                </el-table>
                <div style="margin-top: 20px">
                    <el-button @click="toggleSelection()">取消选择</el-button>
                </div>
            </template>
<!--            <table class="adminInfo" v-bind:data="tableData">-->
<!--                <tr>-->
<!--                    <th>宿舍号</th>-->
<!--                    <th>成员</th>-->
<!--                    <th>电话号码</th>-->
<!--                </tr>-->
<!--            &lt;!&ndash;Vue+ElementUI实现传值给表格&ndash;&gt;-->
<!--                &lt;!&ndash;v-for遍历 &ndash;&gt;-->
<!--                <tr v-for="(user,i) in users">-->
<!--                    <td>1</td>-->
<!--                    <td>11</td>-->
<!--                    <td>111</td>-->
<!--                </tr>-->
<!--            </table>-->
        </div>
    </div>
</div>

<script>
    new Vue({
        el:"#container",
        data:{
            count:2,
            users:[],
            // 表格数据
            tableData: [{
                DepartmentId: '102',
                name: '王小虎',
                tel: '上海市普陀区金沙江路 1518 弄'
            }, {
                DepartmentId: '102',
                name: '王小虎',
                tel: '上海市普陀区金沙江路 1518 弄'
            }, {
                DepartmentId: '102',
                name: '王小虎',
                tel: '上海市普陀区金沙江路 1518 弄'
            }, {
                DepartmentId: '102',
                name: '王小虎',
                tel: '上海市普陀区金沙江路 1518 弄'
            }, {
                DepartmentId: '102',
                name: '王小虎',
                tel: '上海市普陀区金沙江路 1518 弄'
            }, {
                DepartmentId: '102',
                name: '王小虎',
                tel: '上海市普陀区金沙江路 1518 弄'
            }, {
                DepartmentId: '102',
                name: '王小虎',
                tel: '上海市普陀区金沙江路 1518 弄'
            }],
            multipleSelection: []
        },
        // 页面加载完成后，发送异步请求，获取数据
        mounted(){
            let _this = this;
            axios({
                method:"get",
                url:"http://localhost:8080/selectAllServlet"
            }).then(function (resp){
                _this.tableData = resp.data;
            })
        },
        methods:{
            change2(){
                this.count = 2
            },
            change4(){
                this.count = 4
            },
            change5(){
                this.count = 5
            },
            // 表格方法
            toggleSelection(rows) {
                if (rows) {
                    rows.forEach(row => {
                        this.$refs.multipleTable.toggleRowSelection(row);
                    });
                } else {
                    this.$refs.multipleTable.clearSelection();
                }
            },
            handleSelectionChange(val) {
                this.multipleSelection = val;
            }
        }
    });
</script>
</body>

</html>